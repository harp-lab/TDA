<html>
<head>
    <style>
        .hidden {
            visibility: hidden;
        }
    </style>
</head>
<body>
<div id="diagram" class="hidden"></div>
<script src="https://code.jquery.com/jquery-3.7.1.slim.min.js"
        integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"
        integrity="sha512-M7nHCiNUOwFt6Us3r8alutZLm9qMt4s9951uo8jqO4UwJ1hziseL6O3ndFyigx6+LREfZqnhHxYjKRJ8ZQ69DQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="ripser_npm.js"></script>

<script>
    const adjacencyMatrix = [
        [0, 2.83, 6.08, 6.08, 3.6],
        [2.83, 0, 4.12, 5, 4.12],
        [6.08, 4.12, 0, 2, 4.24],
        [6.08, 5, 2, 0, 3.16],
        [3.6, 4.12, 4.24, 3.16, 0]
    ];

    function after_computation() {
        let barcodes = [];
        $('#diagram svg rect').each(function () {
            const title = $(this).find('title');
            if (title.length > 0) {
                const values = title.text().replace(/[\[\],)]/g, '').replace(/[\s]/g, '-').split('-');
                barcodes.push([parseFloat(values[0]), parseFloat(values[1])]);
            }
        });
        console.log(barcodes);
    }

    // Ripser options
    const ripser_options = {
        // outputType: 'PersistenceDiagram',
        format: "distance",
        minDim: 1,
        maxDim: 1,
        callback: after_computation
    };

    $(document).ready(function () {
        Ripser.run(adjacencyMatrix, "#diagram", ripser_options);
    })

</script>
</body>
</html>